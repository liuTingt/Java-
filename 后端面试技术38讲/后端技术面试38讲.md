# 一、程序如何运行又是如何崩溃的

## 1、程序如何运行

可执行的代码被成为程序，程序运行起来被称作进程。程序运行如果需要创建数组等数据结果，操作系统会在进程的堆空间申请一块内存空间，把内存首地址信息记录在进程的栈中。

堆是一块无序的内存空间。

栈是一个先进后出的数据结构。每次函数调用都会在栈中创建栈帧（stack frame），存储正在执行函数的参数、局部变量、申请的内存地址等。

![程序如何运行的](D:\WorkSpace\Java\后端面试技术38讲\后端技术面试38讲.assets\程序如何运行的.png)

## 2、JDK8之后的JVM内存布局

![图摘自《码出高效》](https://upload-images.jianshu.io/upload_images/14923529-c0cbbccaa6858ca1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 程序计数器

Program Count Register是一块较小的内存空间，它可以看作是当前线程所执行的字节码的行号指示器。每条线程有一个独立的程序计数器，是线程私有的内存。

如果线程正在执行一个Java方法，这个计数器记录的是正在执行的虚拟机字节码指令的地址；如果正在执行的是Native方法，这个计数器则为空。

### Java虚拟机栈

Java虚拟机栈也是线程私有的，它的生命周期与线程相同。

虚拟机栈描述的是Java方法执行的内存模型：每个方法在执行的同时都会创建一个栈帧，用于存储局部变量表、操作数栈、动态链接、方法出口等信息。每个方法从调用直至执行完成的过程，对应着栈帧从虚拟机栈入栈和出栈的过程。

![操作栈的压栈与出栈-《码出高效》](https://upload-images.jianshu.io/upload_images/14923529-7a6d6e02c15fff2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



1

2

3

### 本地方法栈



### Java堆

Java堆是Java虚拟机所管理的最大的内存最大的一块。Java堆是被所有线程共享的一块内存区域，用于存放对象实例。

### 方法区







## 3、进程状态



## 4、系统为什么会变慢，为什么会崩溃

现在的服务器软件系统主要使用多线程实现多任务处理。为了解决线程安全问题，使用锁机制，将临界区的代码加锁。锁会引起线程阻塞，如果多线程运行，那么就会出现线程阻塞的情况，线程无法并行执行，系统响应速度就会变慢。此外，I/O操作也会引起阻塞，对数据库连接的获取也会阻塞，如果并发数超过了数据库的连接数，那么就会有部分线程无法获取连接而阻塞，并发的线程越多，等待连接的时间也越多，响应时间就会边长，**系统变慢**。

被阻塞的线程越多，占据的资源也越多，被阻塞的线程即不能执行，也不能释放当前占用的资源，在系统中一边等待一边消耗资源，如果阻塞的线程超过了系统某个系统资源的极限，就会导致系统宕机，**应用崩溃**。

解决高并发导致的系统变慢、应用崩溃主要手段是使用分布式系统架构。



## 名词解释：

**栈帧：**每次函数调用，操作系统会在栈中创建一个栈帧，保存当前执行函数的参数、局部变量、申请内存地址等，栈帧是隔离的，所以不同函数可以定义相同的变量而混淆。

**临界区：**多个线程共享资源的这段代码被称为临界区。

参考资料：https://www.cnblogs.com/czwbig/p/11127124.html

## 二、Hash表的时间复杂度为什么是O(1)

键值对存储，底层